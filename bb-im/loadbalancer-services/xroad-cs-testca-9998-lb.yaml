---
# X-Road Central Server Test CA Port LoadBalancer Service (DEV ONLY)
# Exposes port 9998 (test CA interface) via MetalLB
# WARNING: This service should ONLY be deployed in development/test environments
apiVersion: v1
kind: Service
metadata:
  name: xroad-cs-testca-lb
  namespace: im-ns
  labels:
    app.kubernetes.io/name: xroad-central-server
    app.kubernetes.io/component: central-server
    app.kubernetes.io/part-of: x-road-information-mediator
    govstack.im/port-type: test-ca
    govstack.im/environment: dev
  annotations:
    metallb.universe.tf/loadBalancerIPs: 10.0.0.100
    metallb.universe.tf/allow-shared-ip: "cluster-shared"
    govstack.im/port-description: "X-Road Central Server Test CA (DEV ONLY)"
    govstack.im/external-port: "9998"
    govstack.im/security-warning: "Remove in production environments"
spec:
  type: LoadBalancer
  externalTrafficPolicy: Cluster
  ports:
    - name: test-ca
      protocol: TCP
      port: 9998
      targetPort: 9998
  selector:
    app.kubernetes.io/name: xroad-central-server
    app.kubernetes.io/component: central-server
